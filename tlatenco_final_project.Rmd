---
title: "Final Project"
subtitle: "Data Science for Biologists, Spring 2021"
author: "Sergio Tlatenco"
output: 
  html_document: 
    theme: readable
    highlight: haddock
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# DON'T CHANGE THE NEXT LINE, except to add NEW options if you have any.
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = TRUE, include = TRUE)

# Load all libraries you use HERE:
library(tidyverse)

```

<br><br>

## This dataset examines tuition and cost at colleges and universities across the country. It also includes data on the diversity of US schools and post-graduation pay associated with each school.

```{r read-examine-data}
tuition_cost <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_cost.csv')

tuition_income <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/tuition_income.csv') 

salary_potential <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/salary_potential.csv')

historical_tuition <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/historical_tuition.csv')

diversity_school <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-03-10/diversity_school.csv') 

glimpse(tuition_cost)
glimpse(tuition_income)
glimpse(salary_potential)
glimpse(historical_tuition)
glimpse(diversity_school)


```

<br><br>

## Question 1

#### Is private, for-profit, or public education cheaper in the Northeast or Southeast region of the U.S?

### Methods

```{r NE vs SE question 1 code}

# create variable w/ northeast states
northeast <- c("Connecticut", "Maine", "Massachusetts", "New Hampshire", "New Jersey", "New York", "Pennsylvania", "Rhode Island", "Vermont")

# create variable w/ southeast states
southeast <- c("Alabama", "Florida", "Georgia", "Arkansas", "Louisiana", "Mississippi", "North Carolina", "South Carolina", "Tennessee")

# create variable combining states from previous variables
interest_states <- c(northeast, southeast)

# start pipeline w/ appropriate data
tuition_cost %>%
  # filter for states in specified regions using saved variable combining vectors
  filter(state %in% interest_states) %>%
  # pipe mutate function to create a column that labels school by region
  mutate(us_region = if_else(state %in% northeast, "Northeast", "Southeast")) %>%
  # group schools by reigon and type of institution
  group_by(us_region, type) %>%
  # summarize by mean in state tuition under named column
  summarise(mean_in_state_tuition= mean(in_state_tuition)) %>%
  # pipe ggplot() 
  ggplot() +
  # add aes w/ x reordered and fill mapped to us_region
  aes(x = reorder(type, -mean_in_state_tuition), 
      y = mean_in_state_tuition, 
      fill = us_region) +
  # add geom_col w/ position argument
  geom_col(position = "dodge", 
           color = "gray") + 
  # add custom theme
  theme_minimal() + 
  labs(x = "Type of Institution",
       y = "Mean In-State-Tuition",
       fill = "Us Region")

```


### Answer

For the three types of institutions (private, for-profit, and public), higher education is cheaper in the Southeast as visualized by the plot.  


<br>

## Question 2

#### REPLACE TEXT WITH YOUR QUESTION. Your question should literally be a level-4 header.

### Methods

```{r}

# start pipeline w/ appropriate data
salary_potential %>%
  # filter for states in specified regions using saved variable combining vectors
  filter(state_name %in% interest_states) %>%
  # pipe mutate function to create a column that labels school by region
  mutate(us_region = if_else(state_name %in% northeast, "Northeast", "Southeast")) %>%
  
  group_by(us_region) %>%
  
  summarise(mean_early_career_pay = mean(early_career_pay), 
            mean_mid_career_pay = mean(mid_career_pay)) %>%
   pivot_longer(!us_region, names_to = "career_phase", values_to = "income")%>%
  ggplot() + 
  geom_point(size = 2.8, 
               aes(y = us_region, 
                   x = income, 
                   color = us_region, 
                   shape = career_phase)) +
  scale_shape_discrete(labels=c("Early-Career","Mid-Career"),name= "Career Phase") +
  scale_color_discrete(guide = FALSE)
  



```


### Answer

Replace this text with your answer to your question.

<br><br>

## Question 3

#### REPLACE TEXT WITH YOUR QUESTION. Your question should literally be a level-4 header.

### Methods

### Answer

Replace this text with your answer to your question.


<br><br>

## Question 4

#### REPLACE TEXT WITH YOUR QUESTION. Your question should literally be a level-4 header.

### Methods

### Answer

Replace this text with your answer to your question.
